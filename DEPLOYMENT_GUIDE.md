# èµ„æºä¸Šä¼ è·Ÿè¸ªç³»ç»Ÿéƒ¨ç½²æŒ‡å—

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®ä¸ºç°æœ‰çš„çŸ¥è¯†åº“ä¸Šä¼ ç³»ç»Ÿå¢åŠ äº†å®Œæ•´çš„èµ„æºè·Ÿè¸ªåŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡Tracker IDæŸ¥è¯¢ä¸Šä¼ æ–‡ä»¶çš„å¤„ç†çŠ¶æ€ã€‚

## ğŸ›  æŠ€æœ¯æ ˆ

- **åç«¯**: FastAPI + SQLAlchemy + PostgreSQL
- **å‰ç«¯**: React + TypeScript + Tailwind CSS
- **æ•°æ®åº“**: PostgreSQL with æ–°å¢è·Ÿè¸ªå­—æ®µ

## ğŸ“ é¡¹ç›®ç»“æ„

```
kb_upload_genie/
â”œâ”€â”€ backend/                    # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/v1/
â”‚   â”‚   â”‚   â””â”€â”€ tracker.py     # è·Ÿè¸ªæŸ¥è¯¢API
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â””â”€â”€ article.py     # æ‰©å±•çš„Articleæ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â”‚   â””â”€â”€ tracker.py     # è·Ÿè¸ªç›¸å…³æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â””â”€â”€ tracker_service.py  # è·Ÿè¸ªæœåŠ¡å±‚
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â””â”€â”€ tracker_utils.py    # è·Ÿè¸ªå·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â””â”€â”€ add_tracker_fields.py   # æ•°æ®åº“è¿ç§»è„šæœ¬
â”‚   â””â”€â”€ test_*.py              # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ frontend/                   # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ StatusIndicator.tsx  # çŠ¶æ€æŒ‡ç¤ºå™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ Toast.tsx           # é€šçŸ¥ç³»ç»Ÿ
â”‚   â”‚   â”‚   â””â”€â”€ ErrorBoundary.tsx   # é”™è¯¯è¾¹ç•Œ
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ TrackerQuery.tsx    # è·Ÿè¸ªæŸ¥è¯¢é¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ TrackerTest.tsx     # æµ‹è¯•é¡µé¢
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚       â””â”€â”€ tracker.ts          # è·Ÿè¸ªæœåŠ¡API
â”‚   â””â”€â”€ verify_frontend.js      # å‰ç«¯éªŒè¯è„šæœ¬
â””â”€â”€ DEPLOYMENT_GUIDE.md        # æœ¬æ–‡æ¡£
```

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿ç³»ç»Ÿå·²å®‰è£…ï¼š
- Python 3.8+
- Node.js 16+
- PostgreSQL 12+
- Redis (å¯é€‰ï¼Œç”¨äºç¼“å­˜)

### 2. åç«¯éƒ¨ç½²

#### 2.1 å®‰è£…ä¾èµ–
```bash
cd backend
pip install -r requirements.txt
```

#### 2.2 é…ç½®ç¯å¢ƒå˜é‡
å¤åˆ¶å¹¶ç¼–è¾‘ç¯å¢ƒé…ç½®ï¼š
```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œç¡®ä¿åŒ…å«ï¼š
```env
DATABASE_URL=postgresql://user:password@localhost/dbname
SECRET_KEY=your-secret-key
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
```

#### 2.3 è¿è¡Œæ•°æ®åº“è¿ç§»
```bash
python migrations/add_tracker_fields.py full
```

#### 2.4 å¯åŠ¨åç«¯æœåŠ¡
```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

### 3. å‰ç«¯éƒ¨ç½²

#### 3.1 å®‰è£…ä¾èµ–
```bash
cd frontend
npm install
```

#### 3.2 éªŒè¯å‰ç«¯ç»„ä»¶
```bash
node verify_frontend.js
```

#### 3.3 å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
```

#### 3.4 æ„å»ºç”Ÿäº§ç‰ˆæœ¬
```bash
npm run build
```

### 4. éªŒè¯éƒ¨ç½²

#### 4.1 è¿è¡Œåç«¯æµ‹è¯•
```bash
cd backend
python test_tracker_integration.py
python test_backward_compatibility.py
```

#### 4.2 è®¿é—®åº”ç”¨
- ä¸»ç«™: http://localhost:3000
- è·Ÿè¸ªæŸ¥è¯¢: http://localhost:3000/tracker
- æµ‹è¯•é¡µé¢: http://localhost:3000/tracker-test
- APIæ–‡æ¡£: http://localhost:8000/docs

## ğŸ”§ é…ç½®è¯´æ˜

### æ•°æ®åº“é…ç½®

æ–°å¢çš„æ•°æ®åº“å­—æ®µï¼š
- `articles.method`: ä¸Šä¼ æ–¹æ³• (EMAIL, SIMPLE, APIç­‰)
- `articles.tracker_id`: è·Ÿè¸ªID (æ ¼å¼: TRK-XXXXXXXX-XXXX)
- `articles.processing_status`: å¤„ç†çŠ¶æ€ (pending, processing, completed, rejected)

### APIç«¯ç‚¹

æ–°å¢çš„APIç«¯ç‚¹ï¼š
- `GET /api/v1/tracker/health` - å¥åº·æ£€æŸ¥
- `GET /api/v1/tracker/status/{tracker_id}` - æŸ¥è¯¢è·Ÿè¸ªçŠ¶æ€
- `POST /api/v1/tracker/query` - POSTæ–¹å¼æŸ¥è¯¢çŠ¶æ€

### å‰ç«¯è·¯ç”±

æ–°å¢çš„å‰ç«¯è·¯ç”±ï¼š
- `/tracker` - è·Ÿè¸ªæŸ¥è¯¢é¡µé¢
- `/tracker-test` - ç®€åŒ–æµ‹è¯•é¡µé¢

## ğŸ“± ä½¿ç”¨è¯´æ˜

### ç”¨æˆ·ä½¿ç”¨æµç¨‹

1. **æ–‡ä»¶ä¸Šä¼ **: ç”¨æˆ·é€šè¿‡ä»»æ„æ–¹å¼ä¸Šä¼ æ–‡ä»¶
2. **è·å–Tracker ID**: ç³»ç»Ÿè¿”å›æ ¼å¼ä¸º `TRK-XXXXXXXX-XXXX` çš„è·Ÿè¸ªID
3. **çŠ¶æ€æŸ¥è¯¢**: ç”¨æˆ·è®¿é—® `/tracker` é¡µé¢è¾“å…¥è·Ÿè¸ªID
4. **æŸ¥çœ‹çŠ¶æ€**: ç³»ç»Ÿæ˜¾ç¤ºå¤„ç†çŠ¶æ€ã€è¿›åº¦å’Œè¯¦ç»†ä¿¡æ¯

### çŠ¶æ€è¯´æ˜

- **â³ å¾…å¤„ç†**: æ–‡ä»¶å·²æ¥æ”¶ï¼Œç­‰å¾…å¤„ç†
- **ğŸ”„ å¤„ç†ä¸­**: æ­£åœ¨åˆ†æå’Œå¤„ç†æ–‡ä»¶
- **âœ… å·²å®Œæˆ**: æ–‡ä»¶å¤„ç†å®Œæˆï¼Œå¯ä»¥æ­£å¸¸ä½¿ç”¨
- **âŒ å·²æ‹’ç»**: æ–‡ä»¶å¤„ç†å¤±è´¥æˆ–è¢«æ‹’ç»

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. å‰ç«¯æ¨¡å—å¯¼å…¥é”™è¯¯
```
The requested module '/src/utils/request.ts' does not provide an export named 'request'
```
**è§£å†³æ–¹æ¡ˆ**: æ£€æŸ¥å¯¼å…¥è¯­å¥ï¼Œä½¿ç”¨é»˜è®¤å¯¼å…¥ï¼š
```typescript
import request from '@/utils/request';  // æ­£ç¡®
// import { request } from '@/utils/request';  // é”™è¯¯
```

#### 2. ç»„ä»¶æ¸²æŸ“é”™è¯¯
```
Uncaught TypeError: orig.toString.bind is not a function
```
**è§£å†³æ–¹æ¡ˆ**: æ£€æŸ¥ç»„ä»¶å¯¼å…¥å’Œå‡½æ•°å®šä¹‰ï¼Œç¡®ä¿æ‰€æœ‰ä¾èµ–æ­£ç¡®å¯¼å…¥ã€‚

#### 3. APIè¿æ¥å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**: 
- æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨ (http://localhost:8000)
- æ£€æŸ¥æ•°æ®åº“è¿æ¥æ˜¯å¦æ­£å¸¸
- éªŒè¯ç¯å¢ƒå˜é‡é…ç½®

#### 4. æ•°æ®åº“è¿ç§»å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥æ•°æ®åº“è¿æ¥æƒé™
- ç¡®ä¿PostgreSQLæœåŠ¡æ­£åœ¨è¿è¡Œ
- æ‰‹åŠ¨æ‰§è¡ŒSQLè¯­å¥æ·»åŠ å­—æ®µ

### æ—¥å¿—æŸ¥çœ‹

#### åç«¯æ—¥å¿—
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f logs/app.log

# æŸ¥çœ‹æ•°æ®åº“æŸ¥è¯¢æ—¥å¿—
tail -f logs/db.log
```

#### å‰ç«¯æ—¥å¿—
æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºã€‚

## ğŸ§ª æµ‹è¯•

### å•å…ƒæµ‹è¯•
```bash
cd backend
python -m pytest tests/ -v
```

### é›†æˆæµ‹è¯•
```bash
python test_tracker_integration.py
```

### å‘åå…¼å®¹æ€§æµ‹è¯•
```bash
python test_backward_compatibility.py
```

### å‰ç«¯æµ‹è¯•
```bash
cd frontend
npm test
```

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### æ€§èƒ½ç›‘æ§
- ç›‘æ§APIå“åº”æ—¶é—´
- æ£€æŸ¥æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½
- è§‚å¯Ÿå†…å­˜å’ŒCPUä½¿ç”¨æƒ…å†µ

### æ•°æ®ç»´æŠ¤
- å®šæœŸæ¸…ç†è¿‡æœŸçš„è·Ÿè¸ªè®°å½•
- å¤‡ä»½é‡è¦æ•°æ®
- ç›‘æ§å­˜å‚¨ç©ºé—´ä½¿ç”¨

### å®‰å…¨è€ƒè™‘
- å®šæœŸæ›´æ–°ä¾èµ–åŒ…
- æ£€æŸ¥å®‰å…¨æ¼æ´
- ç›‘æ§å¼‚å¸¸è®¿é—®

## ğŸ”„ æ›´æ–°å’Œå‡çº§

### ä»£ç æ›´æ–°
```bash
# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# æ›´æ–°åç«¯ä¾èµ–
cd backend && pip install -r requirements.txt

# æ›´æ–°å‰ç«¯ä¾èµ–
cd frontend && npm install

# é‡å¯æœåŠ¡
```

### æ•°æ®åº“è¿ç§»
```bash
# è¿è¡Œæ–°çš„è¿ç§»è„šæœ¬
python migrations/new_migration.py
```

## ğŸ“ æ”¯æŒå’Œè”ç³»

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„æ•…éšœæ’é™¤éƒ¨åˆ†
2. æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—
3. è¿è¡Œæµ‹è¯•è„šæœ¬è¯Šæ–­é—®é¢˜
4. è”ç³»ç³»ç»Ÿç®¡ç†å‘˜

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-01-XX)
- âœ… æ·»åŠ èµ„æºä¸Šä¼ è·Ÿè¸ªåŠŸèƒ½
- âœ… å®ç°Tracker IDæŸ¥è¯¢ç³»ç»Ÿ
- âœ… åˆ›å»ºå‰ç«¯çŠ¶æ€æŸ¥è¯¢ç•Œé¢
- âœ… é›†æˆé”™è¯¯å¤„ç†å’Œé€šçŸ¥ç³»ç»Ÿ
- âœ… ä¿è¯å‘åå…¼å®¹æ€§

---

**éƒ¨ç½²å®Œæˆåï¼Œè¯·è®¿é—® http://localhost:3000/tracker æµ‹è¯•è·Ÿè¸ªæŸ¥è¯¢åŠŸèƒ½ï¼** ğŸ‰